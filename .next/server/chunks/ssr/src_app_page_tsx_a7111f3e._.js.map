{"version":3,"sources":["turbopack:///[project]/src/app/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useMemo } from 'react';\n\ntype CreateEventResponse = { code?: string; error?: string; details?: Record<string, string> };\n\nfunction isValidDateDdMmYyyy(v: string): boolean {\n  const m = /^(\\d{2})-(\\d{2})-(\\d{4})$/.exec(v);\n  if (!m) return false;\n  const d = Number(m[1]); const mo = Number(m[2]); const y = Number(m[3]);\n  if (mo < 1 || mo > 12) return false;\n  if (d < 1 || d > 31) return false;\n  return true;\n}\n\nfunction isValidTimeHHMM(v: string): boolean {\n  return /^([01]\\d|2[0-3]):([0-5]\\d)$/.test(v);\n}\n\nfunction maskDate(input: string): string {\n  const digits = input.replace(/\\D+/g, '').slice(0, 8);\n  const dd = digits.slice(0, 2);\n  const mm = digits.slice(2, 4);\n  const yyyy = digits.slice(4, 8);\n  let out = dd;\n  if (mm) out += '-' + mm;\n  if (yyyy) out += '-' + yyyy;\n  return out;\n}\n\nfunction clamp(val: number, min: number, max: number) { return Math.min(Math.max(val, min), max); }\n\nfunction normalizeDate(input: string): string {\n  const m = /^(\\d{1,2})-(\\d{1,2})-(\\d{4})$/.exec(input);\n  if (!m) return input;\n  const d = clamp(Number(m[1]), 1, 31);\n  const mo = clamp(Number(m[2]), 1, 12);\n  const y = Number(m[3]);\n  return `${String(d).padStart(2,'0')}-${String(mo).padStart(2,'0')}-${String(y).padStart(4,'0')}`;\n}\n\nfunction maskTime(input: string): string {\n  const digits = input.replace(/\\D+/g, '').slice(0, 4);\n  const hh = digits.slice(0, 2);\n  const mm = digits.slice(2, 4);\n  let out = hh;\n  if (mm) out += ':' + mm;\n  return out;\n}\n\nfunction normalizeTime(input: string): string {\n  const m = /^(\\d{1,2}):(\\d{1,2})$/.exec(input);\n  if (!m) return input;\n  const hh = clamp(Number(m[1]), 0, 23);\n  const mm = clamp(Number(m[2]), 0, 59);\n  return `${String(hh).padStart(2,'0')}:${String(mm).padStart(2,'0')}`;\n}\n\nexport default function Home() {\n  const [name, setName] = useState('Pickup Match');\n  const [date, setDate] = useState(''); // DD-MM-YYYY\n  const [startTime, setStartTime] = useState(''); // HH:MM 24h\n  const [durationMinutes, setDurationMinutes] = useState(60);\n  const [code, setCode] = useState<string | null>(null);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [submitting, setSubmitting] = useState(false);\n\n  const validate = useMemo(() => {\n    const errs: Record<string, string> = {};\n    if (!name || name.trim().length < 2) errs.name = 'Event name is required';\n    if (!date || !isValidDateDdMmYyyy(date)) errs.date = 'Date must be DD-MM-YYYY';\n    if (!startTime || !isValidTimeHHMM(startTime)) errs.startTime = 'Start time must be HH:MM (24h)';\n    // Prevent past datetime in user's local timezone\n    const [dd, mm, yyyy] = (date||'').split('-').map((x)=>parseInt(x,10));\n    const [hh, mi] = (startTime||'').split(':').map((x)=>parseInt(x,10));\n    if (Number.isFinite(dd) && Number.isFinite(mm) && Number.isFinite(yyyy) && Number.isFinite(hh) && Number.isFinite(mi)) {\n      const local = new Date(yyyy, (mm-1), dd, hh, mi, 0, 0);\n      if (local.getTime() < Date.now()) errs.date = 'Date/time cannot be in the past';\n    }\n    if (!Number.isFinite(Number(durationMinutes)) || durationMinutes <= 0 || durationMinutes > 300) errs.durationMinutes = 'Duration must be 1-300 minutes';\n    return errs;\n  }, [name, date, startTime, durationMinutes]);\n\n  const createEvent = async () => {\n    setSubmitting(true);\n    setErrors(validate);\n    if (Object.keys(validate).length > 0) { setSubmitting(false); return; }\n    const res = await fetch('/api/events', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ name, date, startTime, durationMinutes }),\n    });\n    const data: CreateEventResponse = await res.json();\n    if (res.ok && data.code) { setCode(data.code); setErrors({}); }\n    else {\n      const serverErrs = (data.error === 'validation_error' && data.details) ? data.details : { form: data.error || 'Error' };\n      setErrors(serverErrs);\n    }\n    setSubmitting(false);\n  };\n\n  const link = code ? `${typeof window !== 'undefined' ? window.location.origin : ''}/ev/${code}` : '';\n\n  return (\n    <main className=\"p-6 max-w-2xl mx-auto space-y-6\">\n      <h1 className=\"text-2xl font-bold\">Create Football Event âš½</h1>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n        <div>\n          <label className=\"block text-sm font-medium\">Event Name</label>\n          <input className=\"border rounded p-2 w-full\" value={name} onChange={(e) => setName(e.target.value)} />\n          {errors.name && <p className=\"text-sm text-red-600 mt-1\">{errors.name}</p>}\n        </div>\n        <div>\n          <label className=\"block text-sm font-medium\">Date</label>\n          <input type=\"date\" className=\"border rounded p-2 w-full\" value={(()=>{ const m=/^(\\d{2})-(\\d{2})-(\\d{4})$/.exec(date); return m?`${m[3]}-${m[2]}-${m[1]}`:''; })()} onChange={(e)=>{ const v=e.target.value; const m=/^(\\d{4})-(\\d{2})-(\\d{2})$/.exec(v); setDate(m?`${m[3]}-${m[2]}-${m[1]}`:''); }} min={(()=>{ const now=new Date(); const y=now.getFullYear(); const mo=String(now.getMonth()+1).padStart(2,'0'); const d=String(now.getDate()).padStart(2,'0'); return `${y}-${mo}-${d}`; })()} aria-label=\"Date\" />\n          {errors.date && <p className=\"text-sm text-red-600 mt-1\">{errors.date}</p>}\n        </div>\n        <div>\n          <label className=\"block text-sm font-medium\">Start Time</label>\n          <input\n            type=\"text\"\n            placeholder=\"HH:MM\"\n            className=\"border rounded p-2 w-full\"\n            value={startTime}\n            onChange={(e)=>setStartTime(maskTime(e.target.value))}\n            onBlur={(e)=>setStartTime(normalizeTime(e.target.value))}\n            inputMode=\"numeric\"\n            aria-label=\"Start time HH:MM (24-hour)\"\n          />\n          {errors.startTime && <p className=\"text-sm text-red-600 mt-1\">{errors.startTime}</p>}\n        </div>\n        <div>\n          <label className=\"block text-sm font-medium\">Duration (min)</label>\n          <input type=\"number\" className=\"border rounded p-2 w-full\" value={durationMinutes} onChange={(e) => setDurationMinutes(parseInt(e.target.value || '60', 10))} />\n          {errors.durationMinutes && <p className=\"text-sm text-red-600 mt-1\">{errors.durationMinutes}</p>}\n        </div>\n      </div>\n\n      {errors.form && <p className=\"text-sm text-red-600\">{errors.form}</p>}\n\n      <button onClick={createEvent} disabled={submitting || Object.keys(validate).length > 0} className=\"bg-green-600 disabled:opacity-50 hover:bg-green-700 text-white px-4 py-2 rounded\">Create</button>\n\n      {code && (\n        <div className=\"space-y-2\">\n          <p className=\"text-sm\">Event Code: <b>{code}</b></p>\n          <p className=\"text-sm break-all\">Link: <a href={link} className=\"text-blue-600 underline\">{link}</a></p>\n          <div className=\"border inline-block p-2 rounded\">\n            {/* eslint-disable-next-line @next/next/no-img-element */}\n            <img src={`/api/qrcode?text=${encodeURIComponent(link)}`} alt=\"QR\" width={256} height={256} />\n          </div>\n        </div>\n      )}\n    </main>\n  );\n}\n"],"names":[],"mappings":"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"}