(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,a,l)=>{a.exports=e.r(76562)},96839,e=>{"use strict";e.s(["default",()=>s]);var a=e.i(43476),l=e.i(71645),t=e.i(18566);function s(){var e,s,o,n,i;let r=(0,t.useParams)(),c=(0,t.useSearchParams)(),d=(0,t.useRouter)(),[u,h]=(0,l.useState)(""),[p,x]=(0,l.useState)(""),[v,j]=(0,l.useState)(null),[m,f]=(0,l.useState)(null),[b,g]=(0,l.useState)(null),y=c.get("mode")||"join",[w,N]=(0,l.useState)(!1),[S,C]=(0,l.useState)(null),[k,P]=(0,l.useState)(null),[T,A]=(0,l.useState)(!1),O=async e=>{var a;if(h(e),!e||e.length<3)return void j(null);let l=await fetch("/api/nickname/check",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({handle:e.toLowerCase()})});j(null!=(a=(await l.json()).available)&&a)},E=async()=>{let e=await fetch("/api/users/anonymous",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({handle:u.toLowerCase(),displayName:p||u})}),a=await e.json();if(e.ok){f(a.id);try{"join"===y&&k&&(await fetch("/api/events/".concat(k,"/participants"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:a.id,mode:"join"})})).ok&&A(!0)}catch(e){}}else alert(a.error||"Error")};(0,l.useEffect)(()=>{(async()=>{if(!m)return;let e=await fetch("/api/users/".concat(m,"/card"));e.ok&&g(await e.json())})()},[m]),(0,l.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/me");e.ok&&C(await e.json())}catch(e){}})()},[]),(0,l.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/events?code=".concat(encodeURIComponent(r.code)));if(e.ok){let a=await e.json();P(a.id)}}catch(e){}})()},[r.code]);let I=()=>b||{id:m||"me",foot:"R",pace:3,shoot:3,pass:3,defend:3},R=async()=>{if(!m)return;let e=I();if(!(e&&e.foot&&[e.pace,e.shoot,e.pass,e.defend].every(e=>"number"==typeof e&&e>=1&&e<=5)))return void alert("Please complete your player profile card");let a={foot:e.foot,pace:e.pace,shoot:e.shoot,pass:e.pass,defend:e.defend},l=await fetch("/api/users/".concat(m,"/card"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!l.ok)return void alert((await l.json()).error||"Error");N(!0);let t=await fetch("/api/events?code=".concat(encodeURIComponent(r.code))),s=await t.json();"join"!==y&&await fetch("/api/events/".concat(s.id,"/participants"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({mode:"view"})}),d.push("/ev/".concat(r.code,"/teams"))};return(0,a.jsxs)("main",{className:"p-6 max-w-xl mx-auto space-y-6",children:[(0,a.jsxs)("section",{className:"space-y-3",children:[(0,a.jsx)("h1",{className:"text-xl font-semibold",children:"Nickname"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm",children:"Handle"}),(0,a.jsx)("input",{className:"border rounded p-2 w-full",value:u,onChange:e=>O(e.target.value)}),null!==v&&(0,a.jsx)("p",{className:"text-sm ".concat(v?"text-green-600":"text-red-600"),children:v?"Available":"Taken/Invalid"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm",children:"Display name"}),(0,a.jsx)("input",{className:"border rounded p-2 w-full",value:p,onChange:e=>x(e.target.value)})]}),(0,a.jsx)("button",{disabled:!v,onClick:E,className:"bg-blue-600 disabled:opacity-50 text-white px-4 py-2 rounded",children:"Save handle"})]}),m&&(0,a.jsxs)("section",{className:"space-y-3",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"Player Profile Card (required)"}),(0,a.jsxs)("div",{className:"rounded-xl border bg-white text-black shadow p-4",children:[(0,a.jsx)("div",{className:"text-center font-semibold mb-2",children:p||u||"Your Name"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm",children:"Pace"}),(0,a.jsxs)("select",{className:"border rounded p-2 w-full",value:null!=(e=I().pace)?e:3,onChange:e=>g({...I(),pace:parseInt(e.target.value||"3",10)}),children:[(0,a.jsx)("option",{value:1,children:"1 - Slow"}),(0,a.jsx)("option",{value:2,children:"2 - Below Average"}),(0,a.jsx)("option",{value:3,children:"3 - Average"}),(0,a.jsx)("option",{value:4,children:"4 - Fast"}),(0,a.jsx)("option",{value:5,children:"5 - Very Fast"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm",children:"Shoot"}),(0,a.jsxs)("select",{className:"border rounded p-2 w-full",value:null!=(s=I().shoot)?s:3,onChange:e=>g({...I(),shoot:parseInt(e.target.value||"3",10)}),children:[(0,a.jsx)("option",{value:1,children:"1 - Poor"}),(0,a.jsx)("option",{value:2,children:"2 - Below Average"}),(0,a.jsx)("option",{value:3,children:"3 - Average"}),(0,a.jsx)("option",{value:4,children:"4 - Good"}),(0,a.jsx)("option",{value:5,children:"5 - Excellent"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm",children:"Pass"}),(0,a.jsxs)("select",{className:"border rounded p-2 w-full",value:null!=(o=I().pass)?o:3,onChange:e=>g({...I(),pass:parseInt(e.target.value||"3",10)}),children:[(0,a.jsx)("option",{value:1,children:"1 - Poor"}),(0,a.jsx)("option",{value:2,children:"2 - Below Average"}),(0,a.jsx)("option",{value:3,children:"3 - Average"}),(0,a.jsx)("option",{value:4,children:"4 - Good"}),(0,a.jsx)("option",{value:5,children:"5 - Excellent"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm",children:"Defend"}),(0,a.jsxs)("select",{className:"border rounded p-2 w-full",value:null!=(n=I().defend)?n:3,onChange:e=>g({...I(),defend:parseInt(e.target.value||"3",10)}),children:[(0,a.jsx)("option",{value:1,children:"1 - Poor"}),(0,a.jsx)("option",{value:2,children:"2 - Below Average"}),(0,a.jsx)("option",{value:3,children:"3 - Average"}),(0,a.jsx)("option",{value:4,children:"4 - Good"}),(0,a.jsx)("option",{value:5,children:"5 - Excellent"})]})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm",children:"Preferred Foot"}),(0,a.jsxs)("select",{className:"border rounded p-2 w-full",value:null!=(i=I().foot)?i:"",onChange:e=>g({...I(),foot:e.target.value}),children:[(0,a.jsx)("option",{value:"",children:"Select your preferred foot"}),(0,a.jsx)("option",{value:"R",children:"Right Foot"}),(0,a.jsx)("option",{value:"L",children:"Left Foot"})]})]})]})]}),(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsx)("button",{onClick:R,className:"bg-green-600 text-white px-3 py-2 rounded",children:"Save and continue"})})]})]})}}]);