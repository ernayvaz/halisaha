(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,7818,e=>{e.v(JSON.parse('{"name":"pusher","description":"Node.js client to interact with the Pusher Channels REST API","version":"5.2.0","author":"Pusher <support@pusher.com>","contributors":[{"name":"fabrik42","email":"fabrik42@gmail.com"},{"name":"Jaewoong Kim","email":"jwoongkim@gmail.com"},{"name":"Phil Leggetter","email":"phil@leggetter.co.uk"},{"name":"Paweł Ledwoń","email":"me@ludvik.pl"}],"dependencies":{"abort-controller":"^3.0.0","is-base64":"^1.1.0","node-fetch":"^2.6.1","tweetnacl":"^1.0.0","tweetnacl-util":"^0.15.0","@types/node-fetch":"^2.5.7"},"devDependencies":{"@types/node":"^14.14.6","eslint":"^7.11.0","expect.js":"=0.3.1","express":"^4.17.1","https-proxy-agent":"^5.0.0","mocha":"^7.2.0","nock":"^12.0.3","prettier":"2.1.2","sinon":"=1.10.2","webpack":"^4.42.1","webpack-cli":"^3.3.11"},"scripts":{"local-test":"npx mocha \'tests/integration/**/*.js\'","test":"npx mocha \'tests/{integration,remote}/**/*.js\'","lint":"npx eslint . && npx prettier --check .","format":"npx prettier --write ."},"keywords":["pusher","websockets","realtime"],"license":"MIT","repository":"git://github.com/pusher/pusher-http-node","main":"lib/pusher","typings":"index.d.ts","engines":{"node":">= 4.0.0"}}'))},18566,(e,t,n)=>{t.exports=e.r(76562)},46471,e=>{"use strict";e.s(["default",()=>r]);var t=e.i(43476),n=e.i(71645);function r(e){let{eventCode:r,title:a}=e,[i,l]=(0,n.useState)(null),[o,s]=(0,n.useState)("--:--:--");if((0,n.useEffect)(()=>{if(!r)return;let e=!1,t=async()=>{try{let t=await fetch("/api/events?code=".concat(encodeURIComponent(r)));if(t.ok){let n=await t.json();e||l(n)}}catch(e){}};t();let n=setInterval(t,3e4);return()=>{e=!0,clearInterval(n)}},[r]),(0,n.useEffect)(()=>{if(!(null==i?void 0:i.date)||!(null==i?void 0:i.startTime))return;let e=()=>{try{let[e,t,n]=i.date.split("T")[0].split("-").map(Number),[r,a]=i.startTime.split(":").map(Number),l=new Date(e,t-1,n,r,a),o=new Date,c=l.getTime()-o.getTime();s(function(e){if(e<=0)return"00:00:00";let t=Math.floor(e/36e5),n=Math.floor(e%36e5/6e4),r=Math.floor(e%6e4/1e3);return"".concat(t.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"),":").concat(r.toString().padStart(2,"0"))}(c))}catch(e){s("--:--:--")}};e();let t=setInterval(e,1e3);return()=>clearInterval(t)},[i]),!i)return null;let c=[i.date?(e=>{try{return new Date(e).toLocaleDateString("tr-TR",{day:"2-digit",month:"2-digit",year:"numeric"})}catch(t){return e}})(i.date):null,i.startTime,i.durationMinutes?"".concat(i.durationMinutes," min"):null].filter(Boolean).join(" • ");return(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{children:[a&&(0,t.jsx)("h1",{className:"text-xl font-semibold",children:a}),c&&(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:c})]}),(0,t.jsx)("div",{className:"bg-green-700/70 px-3 py-1 rounded-lg text-sm font-mono text-white border-2 border-white",children:o})]})}},53656,e=>{"use strict";e.s(["default",()=>ea],53656);var t=e.i(43476),n=e.i(71645),r=e.i(18566),a=e.i(7679),i=e.i(47167);let l=(()=>{let e=0;return()=>(e+=1,"u".concat("0000".concat((1679616*Math.random()|0).toString(36)).slice(-4)).concat(e))})();function o(e){let t=[];for(let n=0,r=e.length;n<r;n++)t.push(e[n]);return t}let s=null;function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s||(s=e.includeStyleProperties?e.includeStyleProperties:o(window.getComputedStyle(document.documentElement)))}function d(e,t){let n=(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(t);return n?parseFloat(n.replace("px","")):0}function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{width:t.width||function(e){let t=d(e,"border-left-width"),n=d(e,"border-right-width");return e.clientWidth+t+n}(e),height:t.height||function(e){let t=d(e,"border-top-width"),n=d(e,"border-bottom-width");return e.clientHeight+t+n}(e)}}function h(e){return new Promise((t,n)=>{let r=new Image;r.onload=()=>{r.decode().then(()=>{requestAnimationFrame(()=>t(r))})},r.onerror=n,r.crossOrigin="anonymous",r.decoding="async",r.src=e})}async function m(e){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(e=>"data:image/svg+xml;charset=utf-8,".concat(e))}async function p(e,t,n){let r="http://www.w3.org/2000/svg",a=document.createElementNS(r,"svg"),i=document.createElementNS(r,"foreignObject");return a.setAttribute("width","".concat(t)),a.setAttribute("height","".concat(n)),a.setAttribute("viewBox","0 0 ".concat(t," ").concat(n)),i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.setAttribute("x","0"),i.setAttribute("y","0"),i.setAttribute("externalResourcesRequired","true"),a.appendChild(i),i.appendChild(e),m(a)}let f=(e,t)=>{if(e instanceof t)return!0;let n=Object.getPrototypeOf(e);return null!==n&&(n.constructor.name===t.name||f(n,t))};function x(e,t,n,r){let a=window.getComputedStyle(e,n),i=a.getPropertyValue("content");if(""===i||"none"===i)return;let o=l();try{t.className="".concat(t.className," ").concat(o)}catch(e){return}let s=document.createElement("style");s.appendChild(function(e,t,n,r){let a=".".concat(e,":").concat(t),i=n.cssText?function(e){let t=e.getPropertyValue("content");return"".concat(e.cssText," content: '").concat(t.replace(/'|"/g,""),"';")}(n):c(r).map(e=>{let t=n.getPropertyValue(e),r=n.getPropertyPriority(e);return"".concat(e,": ").concat(t).concat(r?" !important":"",";")}).join(" ");return document.createTextNode("".concat(a,"{").concat(i,"}"))}(o,n,a,r)),t.appendChild(s)}let g="application/font-woff",y="image/jpeg",w={woff:g,woff2:g,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:y,jpeg:y,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function v(e){return w[(function(e){let t=/\.([^./]*?)$/g.exec(e);return t?t[1]:""})(e).toLowerCase()]||""}function b(e){return -1!==e.search(/^(data:)/)}function j(e,t){return"data:".concat(t,";base64,").concat(e)}async function N(e,t,n){let r=await fetch(e,t);if(404===r.status)throw Error('Resource "'.concat(r.url,'" not found'));let a=await r.blob();return new Promise((e,t)=>{let i=new FileReader;i.onerror=t,i.onloadend=()=>{try{e(n({res:r,result:i.result}))}catch(e){t(e)}},i.readAsDataURL(a)})}let k={};async function S(e,t,n){var r,a,i;let l,o,s=(r=e,a=t,i=n.includeQueryParams,o=r.replace(/\?.*/,""),i&&(o=r),/ttf|otf|eot|woff2?/i.test(o)&&(o=o.replace(/.*\//,"")),a?"[".concat(a,"]").concat(o):o);if(null!=k[s])return k[s];n.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());try{let r=await N(e,n.fetchRequestInit,e=>{let{res:n,result:r}=e;return t||(t=n.headers.get("Content-Type")||""),r.split(/,/)[1]});l=j(r,t)}catch(r){l=n.imagePlaceholder||"";let t="Failed to fetch resource: ".concat(e);r&&(t="string"==typeof r?r:r.message),t&&console.warn(t)}return k[s]=l,l}async function C(e){let t=e.toDataURL();return"data:,"===t?e.cloneNode(!1):h(t)}async function E(e,t){if(e.currentSrc){let t=document.createElement("canvas"),n=t.getContext("2d");return t.width=e.clientWidth,t.height=e.clientHeight,null==n||n.drawImage(e,0,0,t.width,t.height),h(t.toDataURL())}let n=e.poster,r=v(n);return h(await S(n,r,t))}async function P(e,t){var n;try{if(null==(n=null==e?void 0:e.contentDocument)?void 0:n.body)return await I(e.contentDocument.body,t,!0)}catch(e){}return e.cloneNode(!1)}async function L(e,t){return f(e,HTMLCanvasElement)?C(e):f(e,HTMLVideoElement)?E(e,t):f(e,HTMLIFrameElement)?P(e,t):e.cloneNode(R(e))}let R=e=>null!=e.tagName&&"SVG"===e.tagName.toUpperCase();async function T(e,t,n){var r,a;if(R(t))return t;let i=[];return 0===(i=null!=e.tagName&&"SLOT"===e.tagName.toUpperCase()&&e.assignedNodes?o(e.assignedNodes()):f(e,HTMLIFrameElement)&&(null==(r=e.contentDocument)?void 0:r.body)?o(e.contentDocument.body.childNodes):o((null!=(a=e.shadowRoot)?a:e).childNodes)).length||f(e,HTMLVideoElement)||await i.reduce((e,r)=>e.then(()=>I(r,n)).then(e=>{e&&t.appendChild(e)}),Promise.resolve()),t}async function M(e,t){let n=e.querySelectorAll?e.querySelectorAll("use"):[];if(0===n.length)return e;let r={};for(let a=0;a<n.length;a++){let i=n[a].getAttribute("xlink:href");if(i){let n=e.querySelector(i),a=document.querySelector(i);n||!a||r[i]||(r[i]=await I(a,t,!0))}}let a=Object.values(r);if(a.length){let t="http://www.w3.org/1999/xhtml",n=document.createElementNS(t,"svg");n.setAttribute("xmlns",t),n.style.position="absolute",n.style.width="0",n.style.height="0",n.style.overflow="hidden",n.style.display="none";let r=document.createElementNS(t,"defs");n.appendChild(r);for(let e=0;e<a.length;e++)r.appendChild(a[e]);e.appendChild(n)}return e}async function I(e,t,n){return n||!t.filter||t.filter(e)?Promise.resolve(e).then(e=>L(e,t)).then(n=>T(e,n,t)).then(n=>(function(e,t,n){if(f(t,Element)&&(!function(e,t,n){let r=t.style;if(!r)return;let a=window.getComputedStyle(e);a.cssText?(r.cssText=a.cssText,r.transformOrigin=a.transformOrigin):c(n).forEach(n=>{let i=a.getPropertyValue(n);if("font-size"===n&&i.endsWith("px")){let e=Math.floor(parseFloat(i.substring(0,i.length-2)))-.1;i="".concat(e,"px")}f(e,HTMLIFrameElement)&&"display"===n&&"inline"===i&&(i="block"),"d"===n&&t.getAttribute("d")&&(i="path(".concat(t.getAttribute("d"),")")),r.setProperty(n,i,a.getPropertyPriority(n))})}(e,t,n),x(e,t,":before",n),x(e,t,":after",n),f(e,HTMLTextAreaElement)&&(t.innerHTML=e.value),f(e,HTMLInputElement)&&t.setAttribute("value",e.value),f(e,HTMLSelectElement))){let n=Array.from(t.children).find(t=>e.value===t.getAttribute("value"));n&&n.setAttribute("selected","")}return t})(e,n,t)).then(e=>M(e,t)):null}let A=/url\((['"]?)([^'"]+?)\1\)/g,D=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,O=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;async function H(e,t,n,r,a){try{let i,l=n?function(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;let n=document.implementation.createHTMLDocument(),r=n.createElement("base"),a=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(a),t&&(r.href=t),a.href=e,a.href}(t,n):t,o=v(t);if(a){let e=await a(l);i=j(e,o)}else i=await S(l,o,r);return e.replace(function(e){let t=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return RegExp("(url\\(['\"]?)(".concat(t,")(['\"]?\\))"),"g")}(t),"$1".concat(i,"$3"))}catch(e){}return e}function F(e){return -1!==e.search(A)}async function V(e,t,n){if(!F(e))return e;let r=function(e,t){let{preferredFontFormat:n}=t;return n?e.replace(O,e=>{for(;;){let[t,,r]=D.exec(e)||[];if(!r)return"";if(r===n)return"src: ".concat(t,";")}}):e}(e,n);return(function(e){let t=[];return e.replace(A,(e,n,r)=>(t.push(r),e)),t.filter(e=>!b(e))})(r).reduce((e,r)=>e.then(e=>H(e,r,t,n)),Promise.resolve(r))}async function U(e,t,n){var r;let a=null==(r=t.style)?void 0:r.getPropertyValue(e);if(a){let r=await V(a,null,n);return t.style.setProperty(e,r,t.style.getPropertyPriority(e)),!0}return!1}async function z(e,t){await U("background",e,t)||await U("background-image",e,t),await U("mask",e,t)||await U("-webkit-mask",e,t)||await U("mask-image",e,t)||await U("-webkit-mask-image",e,t)}async function B(e,t){let n=f(e,HTMLImageElement);if(!(n&&!b(e.src))&&!(f(e,SVGImageElement)&&!b(e.href.baseVal)))return;let r=n?e.src:e.href.baseVal,a=await S(r,v(r),t);await new Promise((r,i)=>{e.onload=r,e.onerror=t.onImageErrorHandler?function(){for(var e=arguments.length,n=Array(e),a=0;a<e;a++)n[a]=arguments[a];try{r(t.onImageErrorHandler(...n))}catch(e){i(e)}}:i,e.decode&&(e.decode=r),"lazy"===e.loading&&(e.loading="eager"),n?(e.srcset="",e.src=a):e.href.baseVal=a})}async function W(e,t){let n=o(e.childNodes).map(e=>G(e,t));await Promise.all(n).then(()=>e)}async function G(e,t){f(e,Element)&&(await z(e,t),await B(e,t),await W(e,t))}let _={};async function q(e){let t=_[e];if(null!=t)return t;let n=await fetch(e);return t={url:e,cssText:await n.text()},_[e]=t,t}async function $(e,t){let n=e.cssText,r=/url\(["']?([^"')]+)["']?\)/g;return Promise.all((n.match(/url\([^)]+\)/g)||[]).map(async a=>{let i=a.replace(r,"$1");return i.startsWith("https://")||(i=new URL(i,e.url).href),N(i,t.fetchRequestInit,e=>{let{result:t}=e;return n=n.replace(a,"url(".concat(t,")")),[a,t]})})).then(()=>n)}function J(e){if(null==e)return[];let t=[],n=e.replace(/(\/\*[\s\S]*?\*\/)/gi,""),r=RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){let e=r.exec(n);if(null===e)break;t.push(e[0])}n=n.replace(r,"");let a=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,i=RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");for(;;){let e=a.exec(n);if(null===e){if(null===(e=i.exec(n)))break;a.lastIndex=i.lastIndex}else i.lastIndex=a.lastIndex;t.push(e[0])}return t}async function K(e,t){let n=[],r=[];return e.forEach(n=>{if("cssRules"in n)try{o(n.cssRules||[]).forEach((e,a)=>{if(e.type===CSSRule.IMPORT_RULE){let i=a+1,l=e.href,o=q(l).then(e=>$(e,t)).then(e=>J(e).forEach(e=>{try{n.insertRule(e,e.startsWith("@import")?i+=1:n.cssRules.length)}catch(t){console.error("Error inserting rule from remote css",{rule:e,error:t})}})).catch(e=>{console.error("Error loading remote css",e.toString())});r.push(o)}})}catch(i){let a=e.find(e=>null==e.href)||document.styleSheets[0];null!=n.href&&r.push(q(n.href).then(e=>$(e,t)).then(e=>J(e).forEach(e=>{a.insertRule(e,a.cssRules.length)})).catch(e=>{console.error("Error loading remote stylesheet",e)})),console.error("Error inlining remote css file",i)}}),Promise.all(r).then(()=>(e.forEach(e=>{if("cssRules"in e)try{o(e.cssRules||[]).forEach(e=>{n.push(e)})}catch(t){console.error("Error while reading CSS rules from ".concat(e.href),t)}}),n))}async function X(e,t){if(null==e.ownerDocument)throw Error("Provided element is not within a Document");let n=o(e.ownerDocument.styleSheets);return(await K(n,t)).filter(e=>e.type===CSSRule.FONT_FACE_RULE).filter(e=>F(e.style.getPropertyValue("src")))}function Q(e){return e.trim().replace(/["']/g,"")}async function Y(e,t){let n=await X(e,t),r=function(e){let t=new Set;return!function e(n){(n.style.fontFamily||getComputedStyle(n).fontFamily).split(",").forEach(e=>{t.add(Q(e))}),Array.from(n.children).forEach(t=>{t instanceof HTMLElement&&e(t)})}(e),t}(e);return(await Promise.all(n.filter(e=>r.has(Q(e.style.fontFamily))).map(e=>{let n=e.parentStyleSheet?e.parentStyleSheet.href:null;return V(e.cssText,n,t)}))).join("\n")}async function Z(e,t){let n=null!=t.fontEmbedCSS?t.fontEmbedCSS:t.skipFonts?null:await Y(e,t);if(n){let t=document.createElement("style"),r=document.createTextNode(n);t.appendChild(r),e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t)}}async function ee(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{width:n,height:r}=u(e,t),a=await I(e,t,!0);return await Z(a,t),await G(a,t),!function(e,t){let{style:n}=e;t.backgroundColor&&(n.backgroundColor=t.backgroundColor),t.width&&(n.width="".concat(t.width,"px")),t.height&&(n.height="".concat(t.height,"px"));let r=t.style;null!=r&&Object.keys(r).forEach(e=>{n[e]=r[e]})}(a,t),await p(a,n,r)}async function et(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{width:n,height:r}=u(e,t),a=await ee(e,t),l=await h(a),o=document.createElement("canvas"),s=o.getContext("2d"),c=t.pixelRatio||function(){let e,t;try{t=i.default}catch(e){}let n=t&&t.env?t.env.devicePixelRatio:null;return n&&Number.isNaN(e=parseInt(n,10))&&(e=1),e||window.devicePixelRatio||1}(),d=t.canvasWidth||n,m=t.canvasHeight||r;return o.width=d*c,o.height=m*c,!t.skipAutoScale&&(o.width>16384||o.height>16384)&&(o.width>16384&&o.height>16384?o.width>o.height?(o.height*=16384/o.width,o.width=16384):(o.width*=16384/o.height,o.height=16384):o.width>16384?(o.height*=16384/o.width,o.width=16384):(o.width*=16384/o.height,o.height=16384)),o.style.width="".concat(d),o.style.height="".concat(m),t.backgroundColor&&(s.fillStyle=t.backgroundColor,s.fillRect(0,0,o.width,o.height)),s.drawImage(l,0,0,o.width,o.height),o}async function en(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(await et(e,t)).toDataURL()}var er=e.i(46471);function ea(){var e,i,l,o,s,c;let d=(0,r.useParams)(),[u,h]=(0,n.useState)(null),[m,p]=(0,n.useState)([]),[f,x]=(0,n.useState)([]),[g,y]=(0,n.useState)([]),[w,v]=(0,n.useState)(1),b=(0,n.useRef)(null),j=(0,n.useRef)(null),N=(0,n.useRef)(null),[k,S]=(0,n.useState)(null),[C,E]=(0,n.useState)(null),P=async e=>{var t;if(S(e),E(null),!e.isGuest&&(null==(t=e.user)?void 0:t.id))try{let t=await fetch("/api/users/".concat(e.user.id,"/card"));if(t.ok){let e=await t.json();E(e)}}catch(e){console.error("Failed to load player card:",e)}};(0,n.useEffect)(()=>{let e=null==d?void 0:d.code;if(!e)return;(async()=>{let t=await fetch("/api/events?code=".concat(encodeURIComponent(e))).then(e=>e.json());h(t);let n=await fetch("/api/events/".concat(t.id,"/teams")).then(e=>e.json());p(n);let r=n.find(e=>e.index===w);if(r){let[e,t]=await Promise.all([fetch("/api/teams/".concat(r.id,"/assignments")).then(e=>e.json()),fetch("/api/teams/".concat(r.id,"/positions")).then(e=>e.json())]);x(e),y(t)}})();let t=()=>{};return(async()=>{let n=await fetch("/api/events?code=".concat(encodeURIComponent(e))).then(e=>e.json());t=(0,a.subscribe)(n.id,e=>{("positions_updated"===e.type||"flags_updated"===e.type||"assignments_updated"===e.type||"teams_updated"===e.type)&&(async()=>{let e=await fetch("/api/events/".concat(n.id,"/teams")).then(e=>e.json());p(e);let t=e.find(e=>e.index===w);if(t){let[e,n]=await Promise.all([fetch("/api/teams/".concat(t.id,"/assignments")).then(e=>e.json()),fetch("/api/teams/".concat(t.id,"/positions")).then(e=>e.json())]);x(e),y(n)}})()})})(),()=>t()},[null==d?void 0:d.code,w]);let L=m.find(e=>e.index===w),R={"1-2-1-1":[{x:.1,y:.5},{x:.3,y:.35},{x:.3,y:.65},{x:.6,y:.5},{x:.85,y:.5}],"1-1-2-1":[{x:.1,y:.5},{x:.3,y:.5},{x:.55,y:.35},{x:.55,y:.65},{x:.85,y:.5}],"1-2-2-1":[{x:.1,y:.5},{x:.25,y:.3},{x:.25,y:.7},{x:.55,y:.35},{x:.55,y:.65},{x:.85,y:.5}],"1-2-2-2":[{x:.1,y:.5},{x:.25,y:.3},{x:.25,y:.7},{x:.55,y:.35},{x:.55,y:.65},{x:.85,y:.35},{x:.85,y:.65}]},T=async()=>{if(!j.current||!L)return;let e=j.current.id;j.current=null;let t=g.find(t=>t.participantId===e);t&&(await fetch("/api/teams/".concat(L.id,"/positions"),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({participantId:e,x:t.x,y:t.y})}),y(await fetch("/api/teams/".concat(L.id,"/positions")).then(e=>e.json())))},M=async()=>{if(!u)return;let e=await fetch("/api/events/".concat(u.id,"/flags"),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({lineupLocked:!u.lineupLocked})});if(e.ok){let t=await e.json();h({...u,lineupLocked:t.lineupLocked})}},I=async()=>{try{let e=N.current;if(!e)return;let t=m.find(e=>e.index===w),n=((null==t?void 0:t.name)||"team".concat(w)).replace(/[^a-z0-9-_]+/gi,"_"),r=await en(e,{cacheBust:!0,backgroundColor:"#ffffff",pixelRatio:2}),a=document.createElement("a");a.href=r,a.download="lineup-".concat(n,".png"),document.body.appendChild(a),a.click(),document.body.removeChild(a)}catch(e){}};return L&&u?(0,t.jsxs)("main",{className:"p-6 max-w-4xl mx-auto space-y-4",children:[(0,t.jsx)(er.default,{eventCode:d.code,title:"Lineup"}),(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:I,className:"border px-3 py-1 rounded",children:"Export PNG"}),(0,t.jsxs)("button",{onClick:M,className:"border px-3 py-1 rounded",children:["Lineup Lock: ",u.lineupLocked?"On":"Off"]})]})}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Drag tokens to set positions. Lineup lock prevents changes."}),(0,t.jsxs)("div",{ref:N,className:"bg-white rounded shadow p-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-4 h-4 rounded",style:{backgroundColor:(null==(e=m.find(e=>e.index===w))?void 0:e.color)||"#16a34a"}}),(0,t.jsx)("div",{className:"font-medium text-sm",children:"Team"})]}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:(null==(i=m.find(e=>e.index===w))?void 0:i.formation)||"1-2-2-1"})]}),(0,t.jsxs)("div",{ref:b,onPointerMove:e=>{if(!b.current||!j.current)return;let t=b.current.getBoundingClientRect(),n=Math.min(Math.max((e.clientX-t.left)/t.width,0),1),r=Math.min(Math.max((e.clientY-t.top)/t.height,0),1),a=j.current.id;y(e=>{let t=e.findIndex(e=>e.participantId===a);if(t>=0){let a=[...e];return a[t]={...a[t],x:n,y:r},a}return L?[...e,{id:"tmp-".concat(a),teamId:L.id,participantId:a,x:n,y:r}]:e})},onPointerUp:T,className:"relative w-full h-80 bg-green-100 rounded overflow-hidden touch-none",children:[(0,t.jsx)("div",{className:"absolute inset-0 grid grid-cols-4 grid-rows-4",children:Array.from({length:16}).map((e,n)=>(0,t.jsx)("div",{className:"border border-green-200"},n))}),f.map((e,n)=>{var r,a;let i,l=(i=e.participantId,g.find(e=>e.participantId===i)||(e=>{let t=R[((null==L?void 0:L.formation)||"1-2-2-1").toString()]||R["1-2-2-1"];if(e<t.length)return t[e];var n=e-t.length;return{x:Math.min(.95,.65+.1*Math.floor(n/4)),y:.2+n%4*.2}})(n)),o=e.participant.isGuest?e.participant.guestName||"Guest":(null==(r=e.participant.user)?void 0:r.displayName)||(null==(a=e.participant.user)?void 0:a.handle)||"Player";return(0,t.jsxs)("div",{className:"absolute cursor-pointer",style:{left:"".concat(100*l.x,"%"),top:"".concat(100*l.y,"%"),transform:"translate(-50%,-50%)"},onPointerDown:t=>{var n;return n=e.participantId,void(b.current&&(null==u||!u.lineupLocked)&&(j.current={id:n},t.target.setPointerCapture(t.pointerId)))},onClick:t=>{t.stopPropagation(),P(e.participant)},children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full bg-green-600 border-2 border-white shadow hover:bg-green-700","aria-label":"Player ".concat(o)}),(0,t.jsx)("div",{className:"text-[10px] mt-1 text-center max-w-[72px] truncate",children:o})]},e.id)})]}),(0,t.jsx)("div",{className:"mt-2 text-[10px] text-gray-500 text-right",children:new Date().toLocaleString()})]}),k&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:()=>S(null),children:(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl max-w-sm w-full overflow-hidden transform transition-all",onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:"relative bg-gradient-to-br from-blue-600 to-purple-700 px-6 py-8 text-white",children:[(0,t.jsx)("button",{onClick:()=>S(null),className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center hover:bg-white/30 transition-colors",children:(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-20 h-20 rounded-full bg-white/20 backdrop-blur-sm text-white text-3xl font-bold flex items-center justify-center mx-auto mb-3 ring-4 ring-white/30",children:(k.isGuest?k.guestName||"G":(null==(l=k.user)?void 0:l.displayName)||(null==(o=k.user)?void 0:o.handle)||"P").slice(0,1).toUpperCase()}),(0,t.jsx)("h4",{className:"text-xl font-bold mb-1",children:k.isGuest?k.guestName||"Guest Player":(null==(s=k.user)?void 0:s.displayName)||(null==(c=k.user)?void 0:c.handle)})]})]}),(0,t.jsx)("div",{className:"p-6",children:k.isGuest?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("div",{className:"w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),(0,t.jsx)("p",{className:"text-gray-500 text-sm",children:"Guest player - no stats available"})]}):C?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"bg-blue-50 rounded-xl p-4 text-center",children:[(0,t.jsx)("div",{className:"text-blue-600 mb-2",children:(0,t.jsx)("svg",{className:"w-6 h-6 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),(0,t.jsx)("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:C.pace||"-"}),(0,t.jsx)("div",{className:"text-xs font-medium text-blue-700",children:"PACE"})]}),(0,t.jsxs)("div",{className:"bg-red-50 rounded-xl p-4 text-center",children:[(0,t.jsx)("div",{className:"text-red-600 mb-2",children:(0,t.jsx)("svg",{className:"w-6 h-6 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z"})})}),(0,t.jsx)("div",{className:"text-2xl font-bold text-red-600 mb-1",children:C.shoot||"-"}),(0,t.jsx)("div",{className:"text-xs font-medium text-red-700",children:"SHOOT"})]}),(0,t.jsxs)("div",{className:"bg-green-50 rounded-xl p-4 text-center",children:[(0,t.jsx)("div",{className:"text-green-600 mb-2",children:(0,t.jsx)("svg",{className:"w-6 h-6 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),(0,t.jsx)("div",{className:"text-2xl font-bold text-green-600 mb-1",children:C.pass||"-"}),(0,t.jsx)("div",{className:"text-xs font-medium text-green-700",children:"PASS"})]}),(0,t.jsxs)("div",{className:"bg-purple-50 rounded-xl p-4 text-center",children:[(0,t.jsx)("div",{className:"text-purple-600 mb-2",children:(0,t.jsx)("svg",{className:"w-6 h-6 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z",clipRule:"evenodd"})})}),(0,t.jsx)("div",{className:"text-2xl font-bold text-purple-600 mb-1",children:C.defend||"-"}),(0,t.jsx)("div",{className:"text-xs font-medium text-purple-700",children:"DEFEND"})]})]}),(0,t.jsxs)("div",{className:"bg-gray-50 rounded-xl p-4 text-center",children:[(0,t.jsx)("div",{className:"text-gray-600 mb-2",children:(0,t.jsx)("svg",{className:"w-6 h-6 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v12a4 4 0 004 4 4 4 0 004-4V5z"})})}),(0,t.jsx)("div",{className:"text-lg font-semibold text-gray-800 mb-1",children:"L"===C.foot?"Left Foot":"R"===C.foot?"Right Foot":"Not specified"}),(0,t.jsx)("div",{className:"text-xs font-medium text-gray-600",children:"PREFERRED FOOT"})]}),(0,t.jsx)("div",{className:"text-center",children:(0,t.jsxs)("div",{className:"inline-flex items-center gap-2 bg-gradient-to-r from-blue-500 to-purple-600 text-white px-4 py-2 rounded-full",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Overall Rating:"}),(0,t.jsx)("span",{className:"text-lg font-bold",children:Math.round(((C.pace||0)+(C.shoot||0)+(C.pass||0)+(C.defend||0))/4*10)/10}),(0,t.jsx)("span",{className:"text-sm",children:"/5"})]})})]}):(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-500",children:"Loading player stats..."})]})})]})})]}):(0,t.jsx)("main",{className:"p-6 max-w-4xl mx-auto",children:"Loading…"})}}]);