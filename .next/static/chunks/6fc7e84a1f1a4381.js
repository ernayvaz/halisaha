(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,7818,e=>{e.v(JSON.parse('{"name":"pusher","description":"Node.js client to interact with the Pusher Channels REST API","version":"5.2.0","author":"Pusher <support@pusher.com>","contributors":[{"name":"fabrik42","email":"fabrik42@gmail.com"},{"name":"Jaewoong Kim","email":"jwoongkim@gmail.com"},{"name":"Phil Leggetter","email":"phil@leggetter.co.uk"},{"name":"Paweł Ledwoń","email":"me@ludvik.pl"}],"dependencies":{"abort-controller":"^3.0.0","is-base64":"^1.1.0","node-fetch":"^2.6.1","tweetnacl":"^1.0.0","tweetnacl-util":"^0.15.0","@types/node-fetch":"^2.5.7"},"devDependencies":{"@types/node":"^14.14.6","eslint":"^7.11.0","expect.js":"=0.3.1","express":"^4.17.1","https-proxy-agent":"^5.0.0","mocha":"^7.2.0","nock":"^12.0.3","prettier":"2.1.2","sinon":"=1.10.2","webpack":"^4.42.1","webpack-cli":"^3.3.11"},"scripts":{"local-test":"npx mocha \'tests/integration/**/*.js\'","test":"npx mocha \'tests/{integration,remote}/**/*.js\'","lint":"npx eslint . && npx prettier --check .","format":"npx prettier --write ."},"keywords":["pusher","websockets","realtime"],"license":"MIT","repository":"git://github.com/pusher/pusher-http-node","main":"lib/pusher","typings":"index.d.ts","engines":{"node":">= 4.0.0"}}'))},18566,(e,t,s)=>{t.exports=e.r(76562)},46471,e=>{"use strict";e.s(["default",()=>a]);var t=e.i(43476),s=e.i(71645);function a(e){let{eventCode:a,title:n}=e,[r,l]=(0,s.useState)(null),[i,o]=(0,s.useState)("--:--:--");if((0,s.useEffect)(()=>{if(!a)return;let e=!1,t=async()=>{try{let t=await fetch("/api/events?code=".concat(encodeURIComponent(a)));if(t.ok){let s=await t.json();e||l(s)}}catch(e){}};t();let s=setInterval(t,3e4);return()=>{e=!0,clearInterval(s)}},[a]),(0,s.useEffect)(()=>{if(!(null==r?void 0:r.date)||!(null==r?void 0:r.startTime))return;let e=()=>{try{let[e,t,s]=r.date.split("T")[0].split("-").map(Number),[a,n]=r.startTime.split(":").map(Number),l=new Date(e,t-1,s,a,n),i=new Date,d=l.getTime()-i.getTime();o(function(e){if(e<=0)return"00:00:00";let t=Math.floor(e/36e5),s=Math.floor(e%36e5/6e4),a=Math.floor(e%6e4/1e3);return"".concat(t.toString().padStart(2,"0"),":").concat(s.toString().padStart(2,"0"),":").concat(a.toString().padStart(2,"0"))}(d))}catch(e){o("--:--:--")}};e();let t=setInterval(e,1e3);return()=>clearInterval(t)},[r]),!r)return null;let d=[r.date?(e=>{try{return new Date(e).toLocaleDateString("tr-TR",{day:"2-digit",month:"2-digit",year:"numeric"})}catch(t){return e}})(r.date):null,r.startTime,r.durationMinutes?"".concat(r.durationMinutes," min"):null].filter(Boolean).join(" • ");return(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{children:[n&&(0,t.jsx)("h1",{className:"text-xl font-semibold",children:n}),d&&(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:d})]}),(0,t.jsx)("div",{className:"bg-green-700/70 px-3 py-1 rounded-lg text-sm font-mono text-white border-2 border-white",children:i})]})}},73574,e=>{"use strict";e.s(["default",()=>l]);var t=e.i(43476),s=e.i(71645),a=e.i(18566),n=e.i(7679),r=e.i(46471);function l(){var e,l,o,d,c,u;let m=(0,a.useParams)(),x=(0,a.useRouter)(),[p,h]=(0,s.useState)(null),[f,v]=(0,s.useState)([]),[j,g]=(0,s.useState)([]),[b,y]=(0,s.useState)([]),[N,w]=(0,s.useState)([]),[k,C]=(0,s.useState)([]),[S,P]=(0,s.useState)([]),[T,L]=(0,s.useState)(!1),[I,M]=(0,s.useState)(!1),[O,R]=(0,s.useState)(null),[A,B]=(0,s.useState)(0),[G,D]=(0,s.useState)(!1),[E,J]=(0,s.useState)(""),[U,V]=(0,s.useState)(null),[z,W]=(0,s.useState)(null),[F,_]=(0,s.useState)({}),H=(0,s.useRef)(()=>{}),K=(0,s.useRef)({}),X=async e=>{var t;if(V(e),W(null),!e.isGuest&&(null==(t=e.user)?void 0:t.id))try{let t=await fetch("/api/users/".concat(e.user.id,"/card"));if(t.ok){let e=await t.json();W(e)}}catch(e){console.error("Failed to load player card:",e)}};async function Y(e){try{let t=await fetch("/api/events?code=".concat(encodeURIComponent(e))).then(e=>e.json()),s=await fetch("/api/events/".concat(t.id,"/poll"));if(!s.ok)return;let a=await s.json(),n=new Date,r=new Date(a.startsAt),l=new Date(a.endsAt);if(a.finalized||n<r||n>l)return;let i=await fetch("/api/me").then(e=>e.ok?e.json():null).catch(()=>null);if(!(null==i?void 0:i.id))return;let o=(await fetch("/api/events/".concat(t.id,"/participants")).then(e=>e.json())).find(e=>{var t;return(null==(t=e.user)?void 0:t.id)===i.id});if(!o)return;Array.isArray(a.votes)&&a.votes.some(e=>e.voterParticipantId===o.id)||x.push("/ev/".concat(e,"/mvp"))}catch(e){}}(0,s.useEffect)(()=>{var e;let t=null==m?void 0:m.code;if(t)return Y(t),(async()=>{let e=await fetch("/api/events?code=".concat(encodeURIComponent(t))).then(e=>e.json());h(e);let[s,a,n]=await Promise.all([fetch("/api/events/".concat(e.id,"/participants")).then(e=>e.json()),fetch("/api/events/".concat(e.id,"/teams")).then(e=>e.json()),fetch("/api/me").then(e=>e.ok?e.json():null).catch(()=>null)]);v(s);let r=a;if(0===r.length){let[t,s]=await Promise.all([fetch("/api/events/".concat(e.id,"/teams"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({index:1,name:"Team 1",color:"#dc2626"})}).then(e=>e.json()),fetch("/api/events/".concat(e.id,"/teams"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({index:2,name:"Team 2",color:"#f59e0b"})}).then(e=>e.json())]);r=[t,s]}if(g(r),null==n?void 0:n.id){let e=s.find(e=>{var t;return(null==(t=e.user)?void 0:t.id)===n.id});L((null==e?void 0:e.role)==="owner")}else L(!1);await q(e.id,r,{}),await Q(e.id,r)})(),null==(e=H.current)||e.call(H),(async()=>{let e=await fetch("/api/events?code=".concat(encodeURIComponent(t))).then(e=>e.json());H.current=(0,n.subscribe)(e.id,s=>{!(O&&Date.now()-O<1500)&&!(A&&Date.now()-A<2e3)&&("participants_updated"===s.type?fetch("/api/events/".concat(e.id,"/participants")).then(e=>e.json()).then(v).catch(()=>{}):"teams_updated"===s.type?(async()=>{let t=await fetch("/api/events/".concat(e.id,"/teams")).then(e=>e.json());g(t),$(t)})().catch(()=>{}):"positions_updated"===s.type?((null==ea?void 0:ea.id)&&fetch("/api/teams/".concat(ea.id,"/positions")).then(e=>e.json()).then(C).catch(()=>{}),(null==en?void 0:en.id)&&fetch("/api/teams/".concat(en.id,"/positions")).then(e=>e.json()).then(P).catch(()=>{})):"flags_updated"===s.type&&fetch("/api/events?code=".concat(encodeURIComponent(t))).then(e=>e.json()).then(h).catch(()=>{}))})})(),()=>{try{var e;null==(e=H.current)||e.call(H)}catch(e){}let t=K.current;K.current={},Object.values(t).forEach(e=>{try{e()}catch(e){}})}},[null==m?void 0:m.code]);let $=e=>{let t=K.current,s=new Set(e.map(e=>e.id));for(let[e,a]of Object.entries(t))if(!s.has(e)){try{a()}catch(e){}delete t[e]}for(let s of e)t[s.id]||(t[s.id]=(0,n.subscribe)(s.id,e=>{"positions_updated"===e.type&&e.teamId===s.id&&fetch("/api/teams/".concat(s.id,"/positions")).then(e=>e.json()).then(e=>{1===s.index?C(e):P(e)}).catch(()=>{})}));K.current=t},q=async(e,t,s)=>{for(let a of t)if(!a.formation){let t=el(s[a.id]||0).map(e=>e.v),n=t.length?t[Math.floor(Math.random()*t.length)]:"1-2-2-1";await fetch("/api/events/".concat(e,"/teams"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({index:a.index,name:a.name,formation:n})})}},Q=async(e,t)=>{let s=t.find(e=>1===e.index),a=t.find(e=>2===e.index);if(s){let[e]=await Promise.all([fetch("/api/teams/".concat(s.id,"/positions")).then(e=>e.json())]);C(e)}if(a){let[e]=await Promise.all([fetch("/api/teams/".concat(a.id,"/positions")).then(e=>e.json())]);P(e)}},Z=e=>j.find(t=>t.index===e),ee=async(e,t)=>{var s,a,n,r,l,i,o,d,c,u,m,x,h;if(!p||!T||I)return;M(!0);let f=Z(e),v={...f,name:null!=(a=null!=(s=t.name)?s:null==f?void 0:f.name)?a:"Team ".concat(e),color:null!=(r=null!=(n=t.color)?n:null==f?void 0:f.color)?r:({1:"#dc2626",2:"#f59e0b"})[e],formation:null!=(i=null!=(l=t.formation)?l:null==f?void 0:f.formation)?i:"1-2-2-1"};g([...j.filter(t=>t.index!==e),v].sort((e,t)=>e.index-t.index));try{let s={index:e,name:null!=(m=null!=(u=t.name)?u:null==(o=Z(e))?void 0:o.name)?m:"Team ".concat(e),color:null!=(x=t.color)?x:null==(d=Z(e))?void 0:d.color,formation:null!=(h=t.formation)?h:null==(c=Z(e))?void 0:c.formation},a=await fetch("/api/events/".concat(p.id,"/teams"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),n=await a.json(),r=j.filter(t=>t.index!==e);g([...r,n].sort((e,t)=>e.index-t.index))}catch(t){console.error("Team update failed:",t),g([...j.filter(t=>t.index!==e),f].sort((e,t)=>e.index-t.index))}M(!1)},et=async()=>{if(!p||!T)return;let e=await fetch("/api/events/".concat(p.id,"/flags"),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({rosterLocked:!p.rosterLocked})});if(e.ok){let t=await e.json();h({...p,rosterLocked:t.rosterLocked})}},es=async()=>{if(p&&T&&confirm("Reset teams and positions? Players will be kept.")){if(M(!0),(await fetch("/api/events/".concat(p.id),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"soft_reset"})})).ok){let[e,t]=await Promise.all([fetch("/api/events/".concat(p.id,"/participants")).then(e=>e.json()),fetch("/api/events/".concat(p.id,"/teams")).then(e=>e.json())]);v(e),g(t),await Q(p.id,t)}M(!1)}},ea=(0,s.useMemo)(()=>Z(1),[j]),en=(0,s.useMemo)(()=>Z(2),[j]);(0,s.useEffect)(()=>{if(!T||!p)return;let e=async e=>{let t=er(e.formation.split("-").map(e=>parseInt(e,10)).reduce((e,t)=>e+t,0));e.formation!==t&&await ee(e.index,{formation:t})};ea&&e(ea),en&&e(en)},[null==ea?void 0:ea.id,null==en?void 0:en.id,T,null==p?void 0:p.id]);let er=e=>{if(e<=1)return"1-0-0-0";if(2===e)return"1-1-0-0";if(3===e)return"1-1-1-0";if(4===e)return"1-1-1-1";if(5===e)return"1-2-1-1";if(6===e)return"1-2-2-1";if(7===e)return"1-2-2-2";if(8===e)return"1-3-2-2";if(9===e)return"1-3-3-2";if(10===e)return"1-3-3-3";let t=e-10,s=[3,3,3];for(let e=0;e<t;e++)s[e%3]++;return"1-".concat(s[0],"-").concat(s[1],"-").concat(s[2])},el=e=>{let t=er(e),s=[{v:t,label:"".concat(t," (Auto)")}],a=new Set([t]);if(e>=3)for(let e of["1-2-2-1","1-1-2-1","1-2-1-1"])a.has(e)||(a.add(e),s.push({v:e,label:e}));return s},ei=e=>{var s;let{p:a}=e,n=(null==(s=a.user)?void 0:s.badges)&&a.user.badges[0];return n?(0,t.jsx)("span",{title:"MVP Lv".concat(n.level),className:"ml-1 text-[10px]",children:"🏅"}):null},eo=e=>{let{team:a,pos:n,setPos:r}=e,l=(0,s.useRef)(null),i=(0,s.useRef)(null);if(!a)return null;let o=(e,t,s)=>Math.min(Math.max(e,t),s),d=async()=>{if(!i.current||!a)return;let e=i.current.id;i.current=null;let t=n.find(t=>t.participantId===e);t&&(!(null==p?void 0:p.lineupLocked)||T)&&T&&(await fetch("/api/teams/".concat(a.id,"/positions"),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({participantId:e,x:t.x,y:t.y})}),r(await fetch("/api/teams/".concat(a.id,"/positions")).then(e=>e.json())))},c=2===a.index;return(0,t.jsxs)("div",{ref:l,onPointerMove:e=>{if(!l.current||!i.current)return;let t=l.current.getBoundingClientRect(),s=o((e.clientX-t.left)/t.width,0,1),n=o((e.clientY-t.top)/t.height,0,1),d=i.current.id;r(e=>{let t=e.findIndex(e=>e.participantId===d);if(t>=0){let a=[...e];return a[t]={...a[t],x:s,y:n},a}return[...e,{id:"tmp-".concat(d),teamId:a.id,participantId:d,x:s,y:n}]})},onPointerUp:d,className:"relative w-full h-48 bg-green-700 rounded overflow-hidden border-2 border-gray-300",children:[(0,t.jsx)("div",{className:"absolute inset-2 border-2 border-white rounded-sm"}),c?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"absolute bottom-2 left-[15%] w-[70%] h-[28%] border-2 border-white"}),(0,t.jsx)("div",{className:"absolute bottom-2 left-[35%] w-[30%] h-[12%] border-2 border-white"}),(0,t.jsx)("div",{className:"absolute w-1.5 h-1.5 bg-white rounded-full",style:{left:"50%",bottom:"18%",transform:"translateX(-50%)"}}),(0,t.jsx)("div",{className:"absolute left-1/2 -translate-x-1/2 -top-8 w-20 h-20 border-2 border-white rounded-full"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"absolute top-2 left-[15%] w-[70%] h-[28%] border-2 border-white"}),(0,t.jsx)("div",{className:"absolute top-2 left-[35%] w-[30%] h-[12%] border-2 border-white"}),(0,t.jsx)("div",{className:"absolute w-1.5 h-1.5 bg-white rounded-full",style:{left:"50%",top:"18%",transform:"translateX(-50%)"}}),(0,t.jsx)("div",{className:"absolute left-1/2 -translate-x-1/2 -bottom-8 w-20 h-20 border-2 border-white rounded-full"})]}),b.map((e,s)=>{var r,o;let d=((e,t)=>{let s=n.find(e=>e.participantId===t);if(s)return{x:s.x,y:s.y};let r=function(e){let t=e.split("-").map(e=>parseInt(e,10)),s=t[1]||0,a=t[2]||0,n=t[3]||0,r=[.28,.56,.86],l=[];return l.push({x:.5,y:.14}),[s,a,n].forEach((e,t)=>{(e=>{if(e<=0)return[];if(1===e)return[.5];let t=[];for(let s=0;s<e;s++)t.push(.2+.6/(e-1)*s);return t})(e).forEach(e=>l.push({x:e,y:r[t]}))}),l}(a.formation);if(e<r.length){let t=r[e];return 2===a.index?{x:t.x,y:1-t.y}:t}let l=e-r.length;return{x:Math.min(.95,.65+.1*Math.floor(l/4)),y:.2+l%4*.2}})(s,e.participantId),c=(e=>{var t,s;let a=b.find(t=>t.participantId===e);return a?a.participant.isGuest?a.participant.guestName||"Guest":(null==(t=a.participant.user)?void 0:t.displayName)||(null==(s=a.participant.user)?void 0:s.handle)||"Player":"Player"})(e.participantId),u=e.participant;return(0,t.jsx)("div",{className:"absolute",style:{left:"".concat(100*d.x,"%"),top:"".concat(100*d.y,"%"),transform:"translate(-50%,-50%)"},onPointerDown:t=>((e,t)=>{if(l.current&&(null==p||!p.lineupLocked||T)){i.current={id:t};try{e.target.setPointerCapture(e.pointerId)}catch(e){}}})(t,e.participantId),onClick:e=>{e.stopPropagation(),X(u)},children:(0,t.jsxs)("div",{className:"relative cursor-pointer flex flex-col items-center",children:[(0,t.jsxs)("div",{className:"relative",children:[((e,s)=>{let a=s||"#86efac",n=function(e){let t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(!t)return"#000";let s=parseInt(t[1],16),a=parseInt(t[2],16);return(.2126*s+.7152*a+.0722*parseInt(t[3],16))/255<.5?"#fff":"#000"}(a);return(0,t.jsx)("div",{className:"w-6 h-6 rounded-full border-2 border-white shadow flex items-center justify-center text-[10px] font-semibold",style:{backgroundColor:a,color:n},title:e,children:(e||"?").slice(0,1).toUpperCase()})})(c,a.color),!u.isGuest&&(0,t.jsx)("span",{className:"absolute -top-2 -right-2 text-[10px]",children:(null==(o=u.user)||null==(r=o.badges)?void 0:r.length)?"🏅":""})]}),(0,t.jsx)("div",{className:"text-[8px] text-white font-medium mt-1 max-w-[50px] truncate bg-black/70 rounded px-1 text-center",children:c})]})},e.id)})]})};return p?(0,t.jsxs)("main",{className:"p-6 max-w-4xl mx-auto space-y-6",children:[(0,t.jsx)(r.default,{eventCode:m.code,title:"Teams"}),(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("button",{onClick:et,disabled:!T,className:"border px-3 py-1 rounded disabled:opacity-50",children:["Roster Lock: ",p.rosterLocked?"On":"Off"]}),(0,t.jsx)("button",{onClick:es,disabled:!T,className:"border px-3 py-1 rounded text-red-600 disabled:opacity-50",children:"Reset Event"})]})}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Assign players via → buttons or use Auto-balance. Only the creator can change teams and positions."}),!T&&(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"You can rearrange locally for preview. Changes are not saved."}),(0,t.jsxs)("section",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"border rounded p-3",children:[(0,t.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,t.jsx)("h3",{className:"font-medium",children:"Players"})}),(0,t.jsx)("ul",{className:"space-y-2",children:f.map(e=>{var s,a,n,r,l,i;return(0,t.jsx)("li",{className:"py-2 flex justify-between items-center",children:(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)("div",{className:"w-6 h-6 rounded-full bg-green-600 text-white text-[11px] flex items-center justify-center cursor-pointer",title:e.isGuest?e.guestName||"Guest Player":(null==(s=e.user)?void 0:s.displayName)||(null==(a=e.user)?void 0:a.handle),onClick:()=>X(e),children:(e.isGuest?e.guestName||"G":(null==(n=e.user)?void 0:n.displayName)||(null==(r=e.user)?void 0:r.handle)||"P").slice(0,1).toUpperCase()}),e.isGuest?(0,t.jsx)("span",{className:"text-sm",children:e.guestName||"Guest ".concat(f.filter(e=>e.isGuest).indexOf(e)+1)}):(0,t.jsx)("span",{className:"text-sm cursor-pointer hover:text-blue-600",onClick:()=>X(e),children:(null==(l=e.user)?void 0:l.displayName)||(null==(i=e.user)?void 0:i.handle)}),!e.isGuest&&(0,t.jsx)(ei,{p:e})]})},e.id)})})]}),(0,t.jsx)("div",{children:(0,t.jsxs)("div",{className:"flex flex-wrap items-center justify-end gap-3",children:[(0,t.jsx)(i,{eventId:p.id,rosterLocked:!!p.rosterLocked,isOwner:T}),(0,t.jsx)("button",{onClick:async()=>{p&&(await fetch("/api/events/".concat(p.id,"/snapshot"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({note:"manual-save"})}),alert("Saved"))},className:"border px-3 py-2 rounded",children:"Save"})]})})]}),(0,t.jsxs)("section",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"border rounded p-3 grid grid-cols-1 md:grid-cols-2 gap-4 h-48",children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("h2",{className:"font-medium",children:"Team 1"}),(0,t.jsx)("input",{disabled:!T,type:"color",defaultValue:(null==ea?void 0:ea.color)||"#dc2626",onChange:e=>{let t=e.target.value.toLowerCase();["#166534","#14532d","#065f46","#064e3b"].includes(t)?(e.target.value="#dc2626",ee(1,{color:"#dc2626"})):ee(1,{color:t})}})]}),(0,t.jsx)("input",{disabled:!T,className:"border rounded p-2 w-full disabled:opacity-50",placeholder:"Team name",defaultValue:(null==ea?void 0:ea.name)||"",onBlur:e=>ee(1,{name:e.target.value||"Team 1"})}),(0,t.jsx)("select",{disabled:!T,className:"border rounded p-2 w-full disabled:opacity-50",value:(null==ea?void 0:ea.formation)||"",onChange:e=>ee(1,{formation:e.target.value}),children:el(0).map(e=>(0,t.jsx)("option",{value:e.v,children:e.label},e.v))}),(0,t.jsxs)("p",{className:"text-[10px] text-gray-500",children:["Players: ",null==ea?void 0:ea.formation.split("-").map(e=>parseInt(e,10)).reduce((e,t)=>e+t,0)]})]}),(0,t.jsxs)("div",{className:"space-y-2 overflow-y-auto",children:[(0,t.jsx)("h3",{className:"font-medium",children:"Team 1 Roster"}),(0,t.jsx)("ul",{className:"space-y-1",children:b.map(e=>{var s,a;return(0,t.jsx)("li",{className:"py-1 text-xs flex justify-between items-center",children:(0,t.jsx)("span",{children:e.participant.isGuest?e.participant.guestName||"Guest Player":(null==(s=e.participant.user)?void 0:s.displayName)||(null==(a=e.participant.user)?void 0:a.handle)})},e.id)})})]})]}),(0,t.jsx)("div",{className:"h-48",children:(0,t.jsx)(eo,{team:ea,pos:k,setPos:C})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsx)("div",{className:"h-48",children:(0,t.jsx)(eo,{team:en,pos:S,setPos:P})}),(0,t.jsxs)("div",{className:"border rounded p-3 grid grid-cols-1 md:grid-cols-2 gap-4 h-48",children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("h2",{className:"font-medium",children:"Team 2"}),(0,t.jsx)("input",{disabled:!T,type:"color",defaultValue:(null==en?void 0:en.color)||"#f59e0b",onChange:e=>{let t=e.target.value.toLowerCase();["#166534","#14532d","#065f46","#064e3b"].includes(t)?(e.target.value="#f59e0b",ee(2,{color:"#f59e0b"})):ee(2,{color:t})}})]}),(0,t.jsx)("input",{disabled:!T,className:"border rounded p-2 w-full disabled:opacity-50",placeholder:"Team name",defaultValue:(null==en?void 0:en.name)||"",onBlur:e=>ee(2,{name:e.target.value||"Team 2"})}),(0,t.jsx)("select",{disabled:!T,className:"border rounded p-2 w-full disabled:opacity-50",value:(null==en?void 0:en.formation)||"",onChange:e=>ee(2,{formation:e.target.value}),children:el(0).map(e=>(0,t.jsx)("option",{value:e.v,children:e.label},e.v))}),(0,t.jsxs)("p",{className:"text-[10px] text-gray-500",children:["Players: ",null==en?void 0:en.formation.split("-").map(e=>parseInt(e,10)).reduce((e,t)=>e+t,0)]})]}),(0,t.jsxs)("div",{className:"space-y-2 overflow-y-auto",children:[(0,t.jsx)("h3",{className:"font-medium",children:"Team 2 Roster"}),(0,t.jsx)("ul",{className:"space-y-1",children:N.map(e=>{var s,a;return(0,t.jsx)("li",{className:"py-1 text-xs flex justify-between items-center",children:(0,t.jsx)("span",{children:e.participant.isGuest?e.participant.guestName||"Guest Player":(null==(s=e.participant.user)?void 0:s.displayName)||(null==(a=e.participant.user)?void 0:a.handle)})},e.id)})})]})]})]})]}),U&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",onClick:()=>V(null),children:(0,t.jsxs)("div",{className:"bg-gray-900 rounded-xl shadow-2xl max-w-xs w-full transform transition-all border border-gray-700",onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:"relative px-4 py-3 border-b border-gray-700",children:[(0,t.jsx)("button",{onClick:()=>V(null),className:"absolute top-2 right-2 w-6 h-6 rounded-full hover:bg-gray-700 flex items-center justify-center transition-colors",children:(0,t.jsx)("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-green-600 text-white text-sm font-bold flex items-center justify-center",children:(U.isGuest?U.guestName||"G":(null==(e=U.user)?void 0:e.displayName)||(null==(l=U.user)?void 0:l.handle)||"P").slice(0,1).toUpperCase()}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-white text-sm",children:U.isGuest?U.guestName||"Guest Player":(null==(o=U.user)?void 0:o.displayName)||(null==(d=U.user)?void 0:d.handle)}),"owner"===U.role&&(0,t.jsx)("span",{className:"inline-flex items-center gap-1 bg-yellow-600 text-yellow-100 px-2 py-0.5 rounded text-xs",children:"👑 Owner"})]})]})]}),(0,t.jsxs)("div",{className:"p-4 bg-gray-900",children:[U.isGuest?(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"grid grid-cols-4 gap-1",children:[(0,t.jsxs)("div",{className:"text-center p-2 bg-gray-800 rounded",children:[(0,t.jsx)("div",{className:"text-sm font-bold text-red-400",children:"3"}),(0,t.jsx)("div",{className:"text-xs text-gray-400",children:"Pace"})]}),(0,t.jsxs)("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 rounded-xl p-4 text-center",children:[(0,t.jsx)("div",{className:"flex items-center justify-center mb-2",children:(0,t.jsx)("svg",{className:"w-5 h-5 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 4V2a1 1 0 011-1h8a1 1 0 011 1v2m-9 3v10a2 2 0 002 2h6a2 2 0 002-2V7H7z"})})}),(0,t.jsx)("p",{className:"text-xs text-orange-700 font-medium mb-1",children:"Shoot"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-orange-800",children:"3"})]}),(0,t.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-4 text-center",children:[(0,t.jsx)("div",{className:"flex items-center justify-center mb-2",children:(0,t.jsx)("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})})}),(0,t.jsx)("p",{className:"text-xs text-blue-700 font-medium mb-1",children:"Pass"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-blue-800",children:"3"})]}),(0,t.jsxs)("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-4 text-center",children:[(0,t.jsx)("div",{className:"flex items-center justify-center mb-2",children:(0,t.jsx)("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.031 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})}),(0,t.jsx)("p",{className:"text-xs text-green-700 font-medium mb-1",children:"Defend"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-green-800",children:"3"})]})]}),(0,t.jsxs)("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 rounded-xl p-4 text-white text-center",children:[(0,t.jsx)("p",{className:"text-sm opacity-90 mb-1",children:"Overall Rating"}),(0,t.jsx)("p",{className:"text-3xl font-bold",children:"12"})]}),(0,t.jsxs)("div",{className:"bg-gray-50 rounded-xl p-4 text-center",children:[(0,t.jsx)("div",{className:"flex items-center justify-center mb-2",children:(0,t.jsx)("svg",{className:"w-6 h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),(0,t.jsx)("p",{className:"text-sm text-gray-600 font-medium mb-1",children:"Preferred Foot"}),(0,t.jsx)("p",{className:"text-lg font-semibold text-gray-800",children:"Right"})]})]}):z?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"bg-blue-50 rounded-xl p-4 text-center",children:[(0,t.jsx)("div",{className:"text-blue-600 mb-2",children:(0,t.jsx)("svg",{className:"w-6 h-6 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),(0,t.jsx)("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:z.pace||"-"}),(0,t.jsx)("div",{className:"text-xs font-medium text-blue-700",children:"PACE"})]}),(0,t.jsxs)("div",{className:"bg-red-50 rounded-xl p-4 text-center",children:[(0,t.jsx)("div",{className:"text-red-600 mb-2",children:(0,t.jsx)("svg",{className:"w-6 h-6 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z"})})}),(0,t.jsx)("div",{className:"text-2xl font-bold text-red-600 mb-1",children:z.shoot||"-"}),(0,t.jsx)("div",{className:"text-xs font-medium text-red-700",children:"SHOOT"})]}),(0,t.jsxs)("div",{className:"bg-green-50 rounded-xl p-4 text-center",children:[(0,t.jsx)("div",{className:"text-green-600 mb-2",children:(0,t.jsx)("svg",{className:"w-6 h-6 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),(0,t.jsx)("div",{className:"text-2xl font-bold text-green-600 mb-1",children:z.pass||"-"}),(0,t.jsx)("div",{className:"text-xs font-medium text-green-700",children:"PASS"})]}),(0,t.jsxs)("div",{className:"bg-purple-50 rounded-xl p-4 text-center",children:[(0,t.jsx)("div",{className:"text-purple-600 mb-2",children:(0,t.jsx)("svg",{className:"w-6 h-6 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z",clipRule:"evenodd"})})}),(0,t.jsx)("div",{className:"text-2xl font-bold text-purple-600 mb-1",children:z.defend||"-"}),(0,t.jsx)("div",{className:"text-xs font-medium text-purple-700",children:"DEFEND"})]})]}),(0,t.jsxs)("div",{className:"bg-gray-50 rounded-xl p-4 text-center",children:[(0,t.jsx)("div",{className:"text-gray-600 mb-2",children:(0,t.jsx)("svg",{className:"w-6 h-6 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v12a4 4 0 004 4 4 4 0 004-4V5z"})})}),(0,t.jsx)("div",{className:"text-lg font-semibold text-gray-800 mb-1",children:"L"===z.foot?"Left Foot":"R"===z.foot?"Right Foot":"Not specified"}),(0,t.jsx)("div",{className:"text-xs font-medium text-gray-600",children:"PREFERRED FOOT"})]}),(0,t.jsx)("div",{className:"text-center",children:(0,t.jsxs)("div",{className:"inline-flex items-center gap-2 bg-gradient-to-r from-blue-500 to-purple-600 text-white px-4 py-2 rounded-full",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Overall Rating:"}),(0,t.jsx)("span",{className:"text-lg font-bold",children:Math.round(((z.pace||0)+(z.shoot||0)+(z.pass||0)+(z.defend||0))/4*10)/10}),(0,t.jsx)("span",{className:"text-sm",children:"/5"})]})})]}):(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-500",children:"Loading player stats..."})]}),!U.isGuest&&(null==(u=U.user)||null==(c=u.badges)?void 0:c.length)>0&&(0,t.jsx)("div",{className:"mt-6 pt-6 border-t border-gray-100",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h5",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Achievements"}),(0,t.jsx)("div",{className:"flex justify-center gap-2 flex-wrap",children:U.user.badges.map((e,s)=>(0,t.jsxs)("div",{className:"bg-gradient-to-r from-yellow-400 to-yellow-500 text-yellow-900 px-3 py-1 rounded-full text-xs font-bold shadow-sm",children:["🏅 MVP Level ",e.level]},s))})]})})]})]})}),I&&(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Processing…"})]}):(0,t.jsx)("main",{className:"p-6 max-w-4xl mx-auto",children:"Loading…"})}function i(e){let{eventId:a,rosterLocked:n,isOwner:r}=e,[l,i]=(0,s.useState)(null),o=async()=>{let e=await fetch("/api/events/".concat(a,"/autobalance"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({method:"greedy",apply:!0})}),t=await e.json();i({scoreA:t.scoreA,scoreB:t.scoreB})};return(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("button",{onClick:o,disabled:n||!r,className:"bg-green-600 disabled:opacity-50 text-white px-3 py-2 rounded",children:"Team-Balance"}),n&&(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Roster is locked. Auto-balance is disabled."}),l&&(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:["Balanced • Score A: ",l.scoreA," • Score B: ",l.scoreB]})]})}}]);